# –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ —Ç–∞–∫—Å–∏-–±–æ—Ç–∞ (—Å–∏—Å—Ç–µ–º–∞ —Å –¥–≤—É–º—è –±–æ—Ç–∞–º–∏)

## üî∑ 1. –û–ë–©–ò–ï –ü–†–ê–í–ò–õ–ê –°–ò–°–¢–ï–ú–´
### 1.1 –†–æ–ª–∏
- **Admin**: –í–ª–∞–¥–µ–ª–µ—Ü —Å–∏—Å—Ç–µ–º—ã. –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ `ADMIN_ID` –≤ `.env`. –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ –≤ –±–æ—Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–∑–Ω–∞—á–∞–µ—Ç—Å—è —Ä–æ–ª—å `admin`.
- **Driver**: –ù–∞–∑–Ω–∞—á–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–æ–º. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –±–æ—Ç–∞ **Driver/Admin**.
- **Client**: –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –±–æ—Ç–∞ **Client**.

### 1.2 –°—Ç–∞—Ç—É—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- `pending`: –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω (–Ω–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å).
- `active`: –ò–º–µ–µ—Ç –ø–æ–ª–Ω–æ–µ –ø—Ä–∞–≤–æ –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã.
- `blocked`: –û—Ç—Å—Ç—Ä–∞–Ω–µ–Ω –æ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –±–æ—Ç–∞ –∞–¥–º–∏–Ω–æ–º.

### 1.3 –°—Ç–∞—Ç—É—Å—ã –∑–∞–∫–∞–∑–æ–≤
- `active`: –ù–æ–≤—ã–π –∑–∞–∫–∞–∑, –æ–∂–∏–¥–∞—é—â–∏–π –≤–æ–¥–∏—Ç–µ–ª—è.
- `taken`: –ó–∞–∫–∞–∑, –ø—Ä–∏–Ω—è—Ç—ã–π –≤–æ–¥–∏—Ç–µ–ª–µ–º.
- `completed`: –£—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–π –∑–∞–∫–∞–∑.
- `cancelled`: –û—Ç–º–µ–Ω–µ–Ω –∫–ª–∏–µ–Ω—Ç–æ–º –∏–ª–∏ –∞–¥–º–∏–Ω–æ–º.

---

## üõ† 0. –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ê–î–ú–ò–ù–ê (–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
- –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ `Config` –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è `ADMIN_ID` (Telegram User ID).
- **–õ–æ–≥–∏–∫–∞:** `if caller_id == ADMIN_ID then set user.role = 'admin', user.status = 'active'`.
- –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞—á–∞—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–æ–π –±–µ–∑ —Ä—É—á–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π (—Å –ø—Ä–∞–≤–∞–º–∏ —Å—É–ø–µ—Ä-–∞–¥–º–∏–Ω–∞).

---

## üîµ 2. –õ–û–ì–ò–ö–ê –ö–õ–ò–ï–ù–¢–ê (–ö–ª–∏–µ–Ω—Ç—Å–∫–∏–π –±–æ—Ç - –ë–æ—Ç 1)
**üéØ –¶–µ–ª—å:** –°–¥–µ–ª–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç (UX) –ø—Ä–æ—Å—Ç—ã–º –∏ –±—ã—Å—Ç—Ä—ã–º.

**–®–ê–ì C1 ‚Äî –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è**
1. –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ `/start`:
   - –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω: `role = client`, `status = pending`.
   - –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (—á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É `–ü–æ–¥–µ–ª–∏—Ç—å—Å—è –Ω–æ–º–µ—Ä–æ–º`).
2. –ü–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–æ–º–µ—Ä–∞:
   - –°—Ç–∞—Ç—É—Å –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ `active`.
   - –í—ã–≤–æ–¥–∏—Ç—Å—è –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ –º–µ–Ω—é –∫–ª–∏–µ–Ω—Ç–∞.

**–®–ê–ì C2 ‚Äî –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ (State Machine)**
1. –ù–∞–∂–∏–º–∞–µ—Ç—Å—è –∫–Ω–æ–ø–∫–∞ **‚ûï –°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑**.
2. –ë–æ—Ç: "üìç –û—Ç–∫—É–¥–∞ –≤–∞—Å –∑–∞–±—Ä–∞—Ç—å?" -> –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–µ–∫—Å—Ç.
3. –ë–æ—Ç: "üèÅ –ö—É–¥–∞ –≤—ã –µ–¥–µ—Ç–µ?" -> –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–µ–∫—Å—Ç.
4. –ë–æ—Ç: "üöï –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∞—Ä–∏—Ñ" -> –°–ø–∏—Å–æ–∫ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `tariffs` –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö (Inline).
5. –ë–æ—Ç: "üë• –°–∫–æ–ª—å–∫–æ —á–µ–ª–æ–≤–µ–∫?" -> –í–≤–æ–¥–∏—Ç—Å—è —á–∏—Å–ª–æ.
6. –ë–æ—Ç: "üìÖ –í—Ä–µ–º—è –≤—ã–µ–∑–¥–∞?" -> –í–≤–æ–¥–∏—Ç—Å—è —Ç–µ–∫—Å—Ç.
7. –ë–æ—Ç: "üí∞ –í—Å–µ –≤–µ—Ä–Ω–æ? [–ü–û–î–¢–í–ï–†–î–ò–¢–¨ | –û–¢–ú–ï–ù–ò–¢–¨]".
8. **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –°–æ–∑–¥–∞–µ—Ç—Å—è –∑–∞–∫–∞–∑ (`status = active`).
9. **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ:** –í—Å–µ –≤–æ–¥–∏—Ç–µ–ª–∏ –≤ **Driver –±–æ—Ç–µ** –ø–æ–ª—É—á–∞—é—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ.

---

## üü° 3. –õ–û–ì–ò–ö–ê –í–û–î–ò–¢–ï–õ–Ø (–í–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –±–æ—Ç - –ë–æ—Ç 2)
**–®–ê–ì D1 ‚Äî –í—Ö–æ–¥ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**
- –í —ç—Ç–æ—Ç –±–æ—Ç –º–æ–≥—É—Ç –≤–æ–π—Ç–∏ —Ç–æ–ª—å–∫–æ —Ç–µ, —É –∫–æ–≥–æ `role = 'driver'`.
- –î–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö: "üö´ –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω".

**–®–ê–ì D2 ‚Äî –ü–æ—Ç–æ–∫ –≤–æ–¥–∏—Ç–µ–ª—è**
1. –ï—Å—Ç—å –∫–Ω–æ–ø–∫–∞ **üì¶ –ê–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–∫–∞–∑—ã**.
2. –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏: –í—ã–≤–æ–¥—è—Ç—Å—è —Ç–æ–ª—å–∫–æ `active` –∑–∞–∫–∞–∑—ã.
3. **"–ü—Ä–∏–Ω—è—Ç—å –∑–∞–∫–∞–∑"** (Inline):
   - –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç: `if order.status == 'active'`.
   - –£—Å–ø–µ—à–Ω–æ: `order.status = 'taken'`, `order.driver_id = current_user_id`.
   - **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ:** –ö–ª–∏–µ–Ω—Ç—É –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Ç–æ–º, —á—Ç–æ –∑–∞–∫–∞–∑ –ø—Ä–∏–Ω—è—Ç.

**–®–ê–ì D3 ‚Äî –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞**
1. **üìã –ú–æ–∏ –∑–∞–∫–∞–∑—ã** -> –í–æ–¥–∏—Ç–µ–ª—å –≤–∏–¥–∏—Ç –ø—Ä–∏–Ω—è—Ç—ã–π –∏–º –∑–∞–∫–∞–∑.
2. **"‚úÖ –ó–∞–≤–µ—Ä—à–∏—Ç—å"**: `order.status = 'completed'`.
3. **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ:** –ö–ª–∏–µ–Ω—Ç—É –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å.

---

## üî¥ 4. –õ–û–ì–ò–ö–ê –ê–î–ú–ò–ù–ê (–ê–¥–º–∏–Ω-–±–æ—Ç - –ë–æ—Ç 3)
**üéØ –¶–µ–ª—å:** –û—Ç–¥–µ–ª—å–Ω—ã–π –∞–¥–º–∏–Ω-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å–∏—Å—Ç–µ–º—ã.

**–®–ê–ì A1 ‚Äî –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∞–¥–º–∏–Ω-–º–µ–Ω—é**
–ï—Å–ª–∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `role == 'admin'`, –µ–º—É –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ –∫–Ω–æ–ø–∫–∏:
- `üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏`: –°–º–µ–Ω–∞ —Ä–æ–ª–µ–π (—Å–¥–µ–ª–∞—Ç—å –∫–ª–∏–µ–Ω—Ç–∞ –≤–æ–¥–∏—Ç–µ–ª–µ–º), –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞.
- `üì¶ –í—Å–µ –∑–∞–∫–∞–∑—ã`: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤.
- `‚öôÔ∏è –¢–∞—Ä–∏—Ñ—ã`: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–ª–∏ —É–¥–∞–ª–µ–Ω–∏–µ —Ç–∞—Ä–∏—Ñ–æ–≤.
- `üó∫ –ì–æ—Ä–æ–¥–∞`: –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –≥–æ—Ä–æ–¥–æ–≤.
- `üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞`: –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∑–∞–∫–∞–∑—ã –∏ –≤—ã—Ä—É—á–∫–∞.

---

## üü£ 5. –ü–†–ê–í–ò–õ–ê –°–¢–ê–¢–£–°–û–í –ò –£–í–ï–î–û–ú–õ–ï–ù–ò–ô
- **–ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª —Å—Ç–∞—Ç—É—Å–∞:** `active` ‚Üí `taken` ‚Üí `completed`.
- **–ê—Ç–æ–º–∞—Ä–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏:** –ü—Ä–∏ –ø—Ä–∏–Ω—è—Ç–∏–∏ –∑–∞–∫–∞–∑–∞ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç—Å—è "–¥–≤–æ–π–Ω–æ–π –∑–∞—Ö–≤–∞—Ç" (–ø—Ä–∏–Ω—è—Ç–∏–µ –¥–≤—É–º—è –ª—é–¥—å–º–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ) —á–µ—Ä–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫—É –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.
- **–°–æ–±—ã—Ç–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:** –¢–æ–ª—å–∫–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞ (—Å–æ–∑–¥–∞–Ω–∏–µ, –ø—Ä–∏–Ω—è—Ç–∏–µ, –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ, –æ—Ç–º–µ–Ω–∞).

---

## üß† –ó–ê–ö–õ–Æ–ß–ò–¢–ï–õ–¨–ù–û–ï –†–ï–ó–Æ–ú–ï
–ù–∞ –æ—Å–Ω–æ–≤–µ —ç—Ç–æ–≥–æ –ø–ª–∞–Ω–∞ –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç —Å **3 –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ —Ç–æ–∫–µ–Ω–∞–º–∏**. –ö–ª–∏–µ–Ω—Ç—ã –ø–æ–ª—å–∑—É—é—Ç—Å—è –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–º –±–æ—Ç–æ–º, –≤–æ–¥–∏—Ç–µ–ª–∏ ‚Äî –≤–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–º, –∞ –∞–¥–º–∏–Ω—ã ‚Äî –∞–¥–º–∏–Ω—Å–∫–∏–º. –ö–∞–∂–¥—ã–π –±–æ—Ç —Å–ª—É–∂–∏—Ç —Å–≤–æ–µ–π —Ä–æ–ª–∏.
